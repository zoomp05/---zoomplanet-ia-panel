# Flujo de Persistencia - Google Ads Account Form

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    FLUJO DE PERSISTENCIA                             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ 1. USUARIO ABRE MODAL "NUEVA CUENTA"                                 โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                    โโโโโโโโโโโโโโโโโโโ
                    โ ยฟHay borrador   โ
                    โ en localStorage?โ
                    โโโโโโโโโโโโโโโโโโโ
                       /             \
                      /               \
                    SI                 NO
                    /                   \
                   โ                     โ
    โโโโโโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโ
    โ Cargar valores       โ    โ Campos vacรญos  โ
    โ desde localStorage   โ    โ (valores por   โ
    โ                      โ    โ defecto)       โ
    โ ๐ฆ Log: "Recuperando"โ    โโโโโโโโโโโโโโโโโโ
    โโโโโโโโโโโโโโโโโโโโโโโโ             

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ 2. USUARIO EDITA CAMPOS                                              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                 โโโโโโโโโโโโโโโโโโโโโโโโโโ
                 โ onValuesChange trigger โ
                 โโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                    โโโโโโโโโโโโโโโโโโโ
                    โ handleFormChangeโ
                    โโโโโโโโโโโโโโโโโโโ
                              โ
              โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
              โ Guardar en localStorage      โ
              โ Key: googleAds_accountForm... โ
              โ                              โ
              โ ๐พ Log: "Guardando borrador" โ
              โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ 3A. USUARIO CIERRA SIN GUARDAR (X o Cancelar)                       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                   โโโโโโโโโโโโโโโโโโโ
                   โ handleCancel    โ
                   โโโโโโโโโโโโโโโโโโโ
                              โ
               โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
               โ NO SE LIMPIA localStorage  โ
               โ                            โ
               โ โธ๏ธ Log: "Modal cerrado,    โ
               โ borrador preservado"       โ
               โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
            โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
            โ Al volver a abrir el modal,      โ
            โ los valores se recuperan         โ
            โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ 3B. USUARIO GUARDA (Crear Cuenta)                                   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                   โโโโโโโโโโโโโโโโโโโ
                   โ handleSubmit    โ
                   โโโโโโโโโโโโโโโโโโโ
                              โ
                  โโโโโโโโโโโโโโโโโโโโ
                  โ form.validate    โ
                  โโโโโโโโโโโโโโโโโโโโ
                       /          \
                      /            \
                   ERROR          SUCCESS
                    /              \
                   โ                โ
        โโโโโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ
        โ Mostrar errores โ  โ onSave()     โ
        โ NO limpiar      โ  โโโโโโโโโโโโโโโโ
        โ localStorage    โ         โ
        โโโโโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโ
                             โ GraphQL Mutation โ
                             โ CREATE_GADS_...  โ
                             โโโโโโโโโโโโโโโโโโโโ
                                  /        \
                                 /          \
                              ERROR        SUCCESS
                               /            \
                              โ              โ
                  โโโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโ
                  โ return false  โ  โ return true      โ
                  โโโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโ
                         |                    |
                         โ                    โ
              โโโโโโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโโโโโ
              โ NO limpiar       โ  โ clearDraft()         โ
              โ localStorage     โ  โ                      โ
              โ                  โ  โ ๐๏ธ Limpiar localStorageโ
              โ Usuario puede    โ  โ                      โ
              โ intentar de nuevoโ  โ form.resetFields()   โ
              โโโโโโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโโโโโ
                                              โ
                                    โโโโโโโโโโโโโโโโโโโโ
                                    โ Modal se cierra  โ
                                    โ Tabla se recarga โ
                                    โโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ESTRUCTURA DE DATOS EN localStorage                                  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

Key: "googleAds_accountForm_draft"

Value (JSON):
{
  "name": "Mi Cuenta de Google Ads",
  "customerId": "123-456-7890",
  "credentials": {
    "clientId": "xxx.apps.googleusercontent.com",
    "clientSecret": "GOCSPX-xxxxx",
    "developerToken": "xxxxx",
    "refreshToken": "1//xxxxx"
  },
  "settings": {
    "currency": "USD",
    "timezone": "America/Mexico_City",
    "autoTaggingEnabled": true
  }
}

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ CASOS DE USO                                                         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โ CASO 1: Usuario cierra por error
   โ Borrador se preserva
   โ Al reabrir, todos los datos estรกn ahรญ

โ CASO 2: Usuario necesita buscar credenciales
   โ Cierra modal para buscar en otro lugar
   โ Al regresar, continรบa donde lo dejรณ

โ CASO 3: Error de red durante guardado
   โ Mutaciรณn falla, pero datos quedan en localStorage
   โ Usuario puede reintentar sin reescribir todo

โ CASO 4: Guardado exitoso
   โ Borrador se limpia automรกticamente
   โ Prรณxima vez, formulario empieza limpio

โ CASO 5: Editar cuenta existente
   โ NO se guarda borrador (solo aplica a creaciรณn)
   โ Previene sobrescribir datos de cuentas diferentes

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ FUNCIONES PRINCIPALES                                                โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ handleFormChange()                                             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ Trigger: onValuesChange del Form                              โ
โ Acciรณn:                                                        โ
โ   1. Verificar que NO estรก editando (isEditing = false)       โ
โ   2. Obtener valores actuales: form.getFieldsValue()          โ
โ   3. Guardar en localStorage como JSON string                 โ
โ   4. Log de confirmaciรณn                                      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ clearDraft()                                                   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ Trigger: Despuรฉs de guardado exitoso                          โ
โ Acciรณn:                                                        โ
โ   1. localStorage.removeItem(STORAGE_KEY)                     โ
โ   2. Log de confirmaciรณn                                      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ handleSubmit()                                                 โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ Trigger: Click en botรณn "Crear Cuenta"                        โ
โ Acciรณn:                                                        โ
โ   1. Validar formulario                                       โ
โ   2. Llamar a onSave(values) y ESPERAR resultado              โ
โ   3. Si result !== false:                                     โ
โ      - clearDraft()                                           โ
โ      - form.resetFields()                                     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ handleCancel()                                                 โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ Trigger: Click en "Cancelar" o X del modal                    โ
โ Acciรณn:                                                        โ
โ   1. Log de preservaciรณn                                      โ
โ   2. Llamar a onCancel()                                      โ
โ   3. NO limpiar localStorage                                  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ useEffect (recuperaciรณn)                                       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ Trigger: Modal se abre (visible = true)                       โ
โ Acciรณn:                                                        โ
โ   SI visible && account (editando):                           โ
โ     โ Cargar datos de la cuenta                               โ
โ   SI visible && !account (creando):                           โ
โ     โ Buscar borrador en localStorage                         โ
โ     โ Si existe, cargar en formulario                         โ
โ     โ Si no existe, resetear campos                           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ DEBUGGING                                                            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

# Ver borrador actual en consola del navegador (F12):
localStorage.getItem('googleAds_accountForm_draft')

# Ver borrador parseado:
JSON.parse(localStorage.getItem('googleAds_accountForm_draft'))

# Limpiar borrador manualmente:
localStorage.removeItem('googleAds_accountForm_draft')

# Ver todos los logs:
# Abrir consola y filtrar por: ๐ฆ ๐พ โธ๏ธ ๐๏ธ
```
